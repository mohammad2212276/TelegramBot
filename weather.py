
import os
import telebot
import requests


BOT_TOKEN = os.environ.get('BOT_TOKEN')


API_KEY = os.environ.get('API_KEY')

CHANNEL_ID = os.environ.get('CHANNEL_ID')

bot = telebot.TeleBot(BOT_TOKEN)


provinces = {
    "ØªÙ‡Ø±Ø§Ù†": (35.6892, 51.3890),
    "Ø§Ù„Ø¨Ø±Ø²": (35.8400, 50.9391),
    "Ø§ØµÙÙ‡Ø§Ù†": (32.6539, 51.6660),
    "Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† Ø´Ø±Ù‚ÛŒ": (38.0667, 46.2993),
    "Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† ØºØ±Ø¨ÛŒ": (37.5527, 45.0760),
    "Ø§Ø±Ø¯Ø¨ÛŒÙ„": (38.2498, 48.2933),
    "Ø§ÛŒÙ„Ø§Ù…": (33.6374, 46.4227),
    "Ø¨ÙˆØ´Ù‡Ø±": (28.9234, 50.8203),
    "Ú†Ù‡Ø§Ø±Ù…Ø­Ø§Ù„ Ùˆ Ø¨Ø®ØªÛŒØ§Ø±ÛŒ": (32.3267, 50.8645),
    "Ø®Ø±Ø§Ø³Ø§Ù† Ø¬Ù†ÙˆØ¨ÛŒ": (32.8663, 59.2211),
    "Ø®Ø±Ø§Ø³Ø§Ù† Ø±Ø¶ÙˆÛŒ": (36.2972, 59.6067),
    "Ø®Ø±Ø§Ø³Ø§Ù† Ø´Ù…Ø§Ù„ÛŒ": (37.4718, 57.1011),
    "Ø®ÙˆØ²Ø³ØªØ§Ù†": (31.3203, 48.6692),
    "Ø²Ù†Ø¬Ø§Ù†": (36.6736, 48.4787),
    "Ø³Ù…Ù†Ø§Ù†": (35.5729, 53.3973),
    "Ø³ÛŒØ³ØªØ§Ù† Ùˆ Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†": (29.4963, 60.8629),
    "ÙØ§Ø±Ø³": (29.5918, 52.5836),
    "Ù‚Ø²ÙˆÛŒÙ†": (36.2730, 50.0041),
    "Ù‚Ù…": (34.6401, 50.8764),
    "Ú©Ø±Ø¯Ø³ØªØ§Ù†": (35.3219, 46.9862),
    "Ú©Ø±Ù…Ø§Ù†": (30.2839, 57.0834),
    "Ú©Ø±Ù…Ø§Ù†Ø´Ø§Ù‡": (34.3142, 47.0650),
    "Ú©Ù‡Ú¯ÛŒÙ„ÙˆÛŒÙ‡ Ùˆ Ø¨ÙˆÛŒØ±Ø§Ø­Ù…Ø¯": (30.6680, 51.5876),
    "Ú¯Ù„Ø³ØªØ§Ù†": (36.8416, 54.4438),
    "Ú¯ÛŒÙ„Ø§Ù†": (37.2808, 49.5832),
    "Ù„Ø±Ø³ØªØ§Ù†": (33.4667, 48.3569),
    "Ù…Ø§Ø²Ù†Ø¯Ø±Ø§Ù†": (36.5659, 53.0586),
    "Ù…Ø±Ú©Ø²ÛŒ": (34.0842, 49.6983),
    "Ù‡Ø±Ù…Ø²Ú¯Ø§Ù†": (27.1832, 56.2666),
    "Ù‡Ù…Ø¯Ø§Ù†": (34.7992, 48.5146),
    "ÛŒØ²Ø¯": (31.8974, 54.3675)
}


message = "ğŸŒ¤ï¸ ÙˆØ¶Ø¹ÛŒØª Ø¢Ø¨ Ùˆ Ù‡ÙˆØ§ Ø¯Ø± Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†:\n\n"


for province, (lat, lon) in provinces.items():
    url = f"https://api.openweathermap.org/data/2.5/weather?lat={lat}&lon={lon}&appid={API_KEY}&units=metric&lang=fa"
    response = requests.get(url)
    data = response.json()
    
    if "main" in data:
        temp = data["main"]["temp"]
        description = data["weather"][0]["description"]
        humidity = data["main"]["humidity"]
        wind_speed = data["wind"]["speed"]
        
        message += f"â›… {province}: {temp}Â°C ({description})\nâ›… Ø±Ø·ÙˆØ¨Øª: {humidity}%\nâ›… Ø¨Ø§Ø¯: {wind_speed} m/s\n\n"
    else:
        message += f"âŒ {province}: Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯\n\n"
message += "@persianagram" 

bot.send_message(CHANNEL_ID, message)

bot.infinity_polling()
